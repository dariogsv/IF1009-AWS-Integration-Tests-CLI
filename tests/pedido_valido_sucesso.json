{
  "scenarioName": "GenericPedidoTest",
  "description": "Cria um pedido via API e verifica seu status no DynamoDB usando ações atômicas.",
  "actions": [
    {
      "name": "CreateOrderHTTPCall",
      "type": "http_call",
      "params": {
        "url": "YOUR_API_GATEWAY_ENDPOINT",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "body": {
          "item": "Headset G",
          "quantidade": 1,
          "uniqueTestId.$": "$$.Execution.Input.testRunId" 
        },
        "expectedStatusCode": 200
      },
      "passToContext": {
        "pedidoId": "$.actionResult.result.pedidoId",
        "timestamp": "$.actionResult.result.timestamp"
      }
    },
    {
      "name": "WaitForOrderProcessing",
      "type": "wait", 
      "params": {
        "seconds": 15
      }
    },
    {
      "name": "VerifyOrderStatusInDB",
      "type": "dynamodb_interact",
      "params": {
        "action": "get_item",
        "table_name": "YOUR_DYNAMODB_TABLE_NAME",
        "key": {
          "pedidoId.$": "$.actions[?(@.name=='CreateOrderHTTPCall')].output.actionResult.result.pedidoId", 
          "timestamp.$": "$.actions[?(@.name=='CreateOrderHTTPCall')].output.actionResult.result.timestamp" 
        }
      },
      "assert": { 
        "type": "equals",
        "path": "$.actionResult.result.status",
        "expected": "PROCESSANDO"
      }
    }
  ],
  "assertions": { 
    "checks": [
      {
        "name": "FinalAPICallStatusCheck",
        "type": "api_response_status",
        "actionIndex": 0, 
        "expectedStatus": 200
      },
      {
        "name": "FinalDBStatusCheck",
        "type": "db_item_value",
        "actionIndex": 2, 
        "key": "status",
        "expectedValue": "PROCESSANDO"
      }
    ]
  },
  "cleanup_actions": [ 
    {
      "name": "CleanupOrderInDB",
      "type": "dynamodb_interact",
      "params": {
        "action": "delete_item",
        "table_name": "YOUR_DYNAMODB_TABLE_NAME",
        "key": {
          "pedidoId.$": "$.actions[?(@.name=='CreateOrderHTTPCall')].output.actionResult.result.pedidoId",
          "timestamp.$": "$.actions[?(@.name=='CreateOrderHTTPCall')].output.actionResult.result.timestamp"
        }
      }
    }
  ]
}